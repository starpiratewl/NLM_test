## test data
## 1.
data(geneid.cummeRbund)                ## all the genes
data(sig.geneid.cummeRbund)            ## DEGs

dim(geneid.cummeRbund)                 ## to see how many genes
## [1] 303   2

dim(sig.geneid.cummeRbund)
## [1] 104   2

head(geneid.cummeRbund)
##    SYMBOL ENTREZID
## 1   OR4F5    79501
## 2  OR4F16    81399
## 3  SAMD11   148398
## 4  KLHL17   339451
## 5 PLEKHN1    84069
## 6   ISG15     9636



head(sig.geneid.cummeRbund)
##    SYMBOL ENTREZID
## 1  KLHL17   339451
## 2 PLEKHN1    84069
## 3    AGRN   375790
## 4  TTLL10   254173
## 5  SCNN1D     6339
## 6    VWA1    64856


library("fdrtool") 
library("MeSH.Hsa.eg.db")

# like topGO, it need to construct a MeSHHyperGParams object to specify all the parameters when do enrichment.
meshParams <- new("MeSHHyperGParams", #
                  geneIds = sig.geneid.cummeRbund[, 2], #
                  universeGeneIds = geneid.cummeRbund[, 2], #
                  annotation = "MeSH.Hsa.eg.db", #
                  category = "C", # like the classification of BP,MF,CC in GO
                  database = "gendoo", #can be gendoo, gene2pubmed or RBBH
                  pvalueCutoff = 0.05, #
                  pAdjust = "none") ## pAdjust is set to none because this is really a very limited example,most of the times we can set it to BH, QV or FDR.
                  
                  
meshR <- meshHyperGTest(meshParams)             ## hypergeometry calculation of pvalue

meshR                                           ## to see what kind of object the mesh is, is it like a GO?
##MeSH enrichment analysis for category Diseases 
##Annotation package used:  MeSH.Hsa.eg.db 
##The correspondance is retrived from:  gendoo 
##Number of MeSH terms identified:  9 

head(summary(meshR))
##       MESHID       Pvalue OddsRatio ExpCount Count Size              MESHTERM GENEID SOURCEID
##15774 D009361 0.0002619206  3.942771 11.32673    21   33 Neoplasm Invasiveness   1576     <NA>
##15775 D009361 0.0002619206  3.942771 11.32673    21   33 Neoplasm Invasiveness   6279     <NA>
##15776 D009361 0.0002619206  3.942771 11.32673    21   33 Neoplasm Invasiveness   2778     <NA>
##15777 D009361 0.0002619206  3.942771 11.32673    21   33 Neoplasm Invasiveness    894     <NA>
##15778 D009361 0.0002619206  3.942771 11.32673    21   33 Neoplasm Invasiveness   2524     <NA>
##15779 D009361 0.0002619206  3.942771 11.32673    21   33 Neoplasm Invasiveness   7306     <NA>



















## another example
library(meshr)
library(fdrtool)
library(MeSH.Hsa.eg.db)
allgene <- select(MeSH.Hsa.eg.db, columns="GENEID", keytype="SOURCEDB", keys="gene2pubmed")
siggene <- sig.geneid.cummeRbund[, 2]
meshParams <- new("MeSHHyperGParams", 
                  geneIds = siggene,
                  universeGeneIds = allgene[,1],
                  annotation = "MeSH.Hsa.eg.db", 
                  category = "G", 
                  database = "gene2pubmed",
                  pvalueCutoff = 0.05,
                  pAdjust = "QV")
output <- meshHyperGTest(meshParams)
save.pdf(output)  ## save all the pdf files, be careful to use this...
















13605515876 hu













